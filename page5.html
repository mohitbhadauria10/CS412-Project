<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title> US Cumulative Confirmed and Death Cases Statewise </title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://d3js.org/d3.v4.js" charset="utf-8"></script>
</head>
<body bgcolor="#ffffff">
    <center>
        <p>
            <font size="6" face="Arial Black">
                Statewise cumulative monthly COVID-19 Deaths
            </font>
        </p>
    </center>

    <div class="chart-wrapper" id="chart-line1">
        <p>
            <font size="4" face="Arial">
                 This chart shows cumulative COVID-19 death cases in every state in United States from when pandemic started until now (Jan 2020-July 2021).<br> User can click in any month from January 2020 to July 2021 and can view COVID-19 deaths in any state and its comparision with other states.User can also hover over the bar chart of any state and can see exact death cases in that state.States with maximum and minimum number of deaths can be easily identified by bar chart.
            </font>
        </p>
    </div>
    <center>
      <p></p>
      <a class="button1" href="page4.html" style="margin-right: 200px">Previous</a>
      <font size="5" face="Arial Black">
          <a class="scene2" href="page4.html">Statewise Confirmed Cases</a>
          |
          <a class="scene3" href="page5.html">Statewise Deaths</a>
      </font>
      <a class="button1" href="index.html" style="margin-left: 200px" >Start</a>
  </center>
<center>
<!-- Add 7 buttons -->
<button onclick="update('January')"> 2020-January </button>
<button onclick="update('Feburary')"> Feburary </button>
<button onclick="update('March')"> March </button>
<button onclick="update('April')"> April </button>
<button onclick="update('May')"> May </button>
<button onclick="update('June')"> June </button>
<button onclick="update('July')"> July </button>
<button onclick="update('August')"> August </button>
<button onclick="update('September')"> September </button>
<button onclick="update('October')"> October </button>
<button onclick="update('November')"> November </button>
<button onclick="update('December')"> December </button>
<button onclick="update('2021January')"> 2021-January </button>
<button onclick="update('2021February')"> 2021-February </button>
<button onclick="update('2021March')"> 2021-March </button>
<button onclick="update('2021April')"> 2021-April </button>
<button onclick="update('2021May')"> 2021-May </button>
<button onclick="update('2021June')"> 2021-June </button>
<button onclick="update('2021July')"> 2021-July </button>
<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>
</center>

<script>

// set the dimensions and margins of the graph
var margin = {top: 10, right: 100, bottom: 90, left: 100},
    width = 1800 - margin.left - margin.right,
    height = 650 - margin.top - margin.bottom;

// append the svg object to the body of the page
var svg = d3.select("#my_dataviz")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

// A function that create / update the plot for a given variable:
function update(selectedVar) {

d3.csv("data/State_Death-1.csv", function(data) {

svg.append("rect").attr("width",20).attr("height",20).attr("x", 40).attr("y", -10).style("fill", "#dd5143")
svg.append("text").attr("x", 70).attr("y", 0).text("Death Cases each Statewise").style("font-size", "17px").attr("alignment-baseline","middle")

// X axis
var x = d3.scaleBand()
  .range([ 0, width ])
  .domain(data.map(function(d) { return d.Code; }))
  .padding(0.2);
svg.append("g")
  .attr("transform", "translate(0," + height + ")")
  .call(d3.axisBottom(x))

//Y axis
var y = d3.scaleLinear()
  .domain([0, 70000])
  .range([ height, 0]);
svg.append("g")
  .call(d3.axisLeft(y));


var tooltip = d3.select("div")
    .append("rect")
    .style("opacity", 0)
    .attr("class", "tooltip")
    .style("background-color", "#dd5143")
    .style("color", "white")
    .style("border-radius", "10px")
    .style("padding", "10px")
    .style("font","36px")
  // A function that change this tooltip when the user hover a point.
  // Its opacity is set to 1: we can now see it. Plus it set the text and position of tooltip depending on the datapoint (d)
var mouseover = function(d) {
  tooltip
      .transition()
      .duration(100)
      .style("opacity", 1)
  tooltip
    .html(d.Code +"-Death Cases: " + d[selectedVar])
      .style("left", (d3.mouse(this)[0]+200) + "px")
      .style("top", (d3.mouse(this)[1]-20) + "px")
      .duration(100)
      .style("opacity", 1)

  }
var mousemove = function(d) {
    tooltip
      .html(d.Code +"-Death Cases: " + d[selectedVar])
      .style("left", (d3.mouse(this)[0]+200) + "px")
      .style("top", (d3.mouse(this)[1]-20) + "px")
  }
  // A function that change this tooltip when the leaves a point: just need to set opacity to 0 again
  var mouseout = function(d) {
    tooltip
      .transition()
      .duration(100)
      .style("opacity", 0)
  }

var u = svg.selectAll("rect")
      .data(data)
u
  .enter()
  .append("rect")
  .merge(u)
  //.transition()
  //.duration(1000)
    .attr("x", function(d) { return x(d.Code); })
    .attr("y", function(d) { return y(d[selectedVar]); })
    .attr("width", x.bandwidth())
    .attr("height", function(d) { return height - y(d[selectedVar]); })
    .attr("fill", "#dd5143")
    .on('mouseover', mouseover)
  .on('mousemove', mousemove)
  .on('mouseout', mouseout);
})
}
// Initialize plot
update('July')

</script>



</body>
</html>